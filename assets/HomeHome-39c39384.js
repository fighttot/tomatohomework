import{u as F}from"./List-77f209d0.js";import{u as D}from"./settings-c66164a5.js";import{g as G,o as L,a as P,b as M,n as H,u as I,r as x,w as W,c as V,s as j,d as T,e as C,f as u,V as q,h as g,i as b,t as E,j as w,k as S,l as R,m as k}from"./index-06c53332.js";import{V as N,a as $}from"./VRow-f361f1c0.js";function O(e){return G()?(L(e),!0):!1}function _(){const e=new Set,t=s=>{e.delete(s)};return{on:s=>{e.add(s);const o=()=>t(s);return O(o),{off:o}},off:t,trigger:s=>Promise.all(Array.from(e).map(o=>o(s)))}}function U(e){return typeof e=="function"?e():I(e)}const z=typeof window<"u",J=()=>{};function K(e,t=!0){P()?M(e):t?e():H(e)}function Q(e){var t;const r=U(e);return(t=r==null?void 0:r.$el)!=null?t:r}const B=z?window:void 0;function X(...e){let t,r,n,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([r,n,s]=e,t=B):[t,r,n,s]=e,!t)return J;Array.isArray(r)||(r=[r]),Array.isArray(n)||(n=[n]);const o=[],a=()=>{o.forEach(l=>l()),o.length=0},c=(l,f,d,m)=>(l.addEventListener(f,d,m),()=>l.removeEventListener(f,d,m)),p=W(()=>[Q(t),U(s)],([l,f])=>{a(),l&&o.push(...r.flatMap(d=>n.map(m=>c(l,d,m,f))))},{immediate:!0,flush:"post"}),v=()=>{p(),a()};return O(v),v}function Y(){const e=x(!1);return P()&&M(()=>{e.value=!0}),e}function Z(e){const t=Y();return V(()=>(t.value,!!e()))}function ee(e={}){const{window:t=B}=e,r=Z(()=>!!t&&"Notification"in t),n=x(null),s=async()=>{r.value&&"permission"in Notification&&Notification.permission!=="denied"&&await Notification.requestPermission()},{on:o,trigger:a}=_(),{on:c,trigger:p}=_(),{on:v,trigger:l}=_(),{on:f,trigger:d}=_(),m=async h=>{if(!r.value)return;await s();const i=Object.assign({},e,h);return n.value=new Notification(i.title||"",i),n.value.onclick=a,n.value.onshow=p,n.value.onerror=l,n.value.onclose=d,n.value},y=()=>{n.value&&n.value.close(),n.value=null};if(K(async()=>{r.value&&await s()}),O(y),r.value&&t){const h=t.document;X(h,"visibilitychange",i=>{i.preventDefault(),h.visibilityState==="visible"&&y()})}return{isSupported:r,notification:n,show:m,close:y,onClick:o,onShow:c,onError:v,onClose:f}}const se={__name:"HomeHome",setup(e){const t=F(),{items:r,currentItem:n,timeleft:s}=j(t),o=D(),a={STOP:0,COUNTING:1,PAUSE:2},c=x(a.STOP);let p=0;const v=()=>{c.value===a.STOP&&r.value.length>0&&t.setCurrentItem(),n.value.length!==0&&(c.value=a.COUNTING,p=setInterval(()=>{t.countdown(),s.value===0&&f()},1e3))},l=()=>{c.value=a.PAUSE,clearInterval(p)},f=()=>{clearInterval(p),c.value=a.STOP;const i=new Audio;if(i.src=o.selectsdAlarmFile,i.play(),o.notify){const{show:A}=ee({title:"事項完成",body:d.value,icon:o.selectsdImg});A()}t.setFinishItem(),r.value.length>0&&v()},d=V(()=>n.value.length>0?n.value:r.value.length>0?"點擊開始":"沒有事項"),m=V(()=>{const i=Math.floor(s.value/60).toString().padStart(2,"0"),A=(s.value%60).toString().padStart(2,"0");return i+":"+A}),y=()=>{o.selectedAlarm>1?o.selectedAlarm--:o.selectedAlarm=6;const i=new Audio;i.src=o.selectsdAlarmFile,i.play()},h=()=>{o.selectedAlarm<6?o.selectedAlarm++:o.selectedAlarm=1;const i=new Audio;i.src=o.selectsdAlarmFile,i.play()};return(i,A)=>(T(),C(q,null,{default:u(()=>[g($,{class:"text-center"},{default:u(()=>[g(N,{cols:"12"},{default:u(()=>[b("h1",null,E(d.value),1),b("h1",null,E(m.value),1)]),_:1}),g(N,{cols:"12"},{default:u(()=>[g(w,{onClick:y},{default:u(()=>[S("上一首鈴聲")]),_:1}),g(R,{src:I(o).selectsdImg,height:350,width:350,cover:"",style:{display:"inline-block","border-radius":"45%"}},null,8,["src"]),g(w,{onClick:h},{default:u(()=>[S("下一首鈴聲")]),_:1})]),_:1}),g(N,{cols:"12"},{default:u(()=>[c.value!==a.COUNTING?(T(),C(w,{key:0,variant:"text","prepend-icon":"mdi-play",onClick:v},{default:u(()=>[S("開始")]),_:1})):k("",!0),c.value===a.COUNTING?(T(),C(w,{key:1,variant:"text","prepend-icon":"mdi-pause",onClick:l},{default:u(()=>[S("暫停")]),_:1})):k("",!0),I(n).length>0?(T(),C(w,{key:2,variant:"text","prepend-icon":"mdi-skip-next",onClick:f},{default:u(()=>[S("跳過")]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1}))}};export{se as default};
