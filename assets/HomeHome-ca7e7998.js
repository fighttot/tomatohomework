import{u as D}from"./List-876b646a.js";import{u as G}from"./settings-70704c5c.js";import{g as L,o as F,a as P,b as M,n as H,u as _,r as V,w as W,c as I,s as j,d as T,e as C,f as p,V as q,h as g,i as O,t as b,j as w,k as E,l as R,m as A}from"./index-e68080f0.js";import{V as N,a as $}from"./VRow-521d423e.js";function x(e){return L()?(F(e),!0):!1}function k(){const e=new Set,t=s=>{e.delete(s)};return{on:s=>{e.add(s);const r=()=>t(s);return x(r),{off:r}},off:t,trigger:s=>Promise.all(Array.from(e).map(r=>r(s)))}}function U(e){return typeof e=="function"?e():_(e)}const z=typeof window<"u",J=()=>{};function K(e,t=!0){P()?M(e):t?e():H(e)}function Q(e){var t;const o=U(e);return(t=o==null?void 0:o.$el)!=null?t:o}const B=z?window:void 0;function X(...e){let t,o,n,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,n,s]=e,t=B):[t,o,n,s]=e,!t)return J;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const r=[],i=()=>{r.forEach(a=>a()),r.length=0},l=(a,u,f,d)=>(a.addEventListener(u,f,d),()=>a.removeEventListener(u,f,d)),m=W(()=>[Q(t),U(s)],([a,u])=>{i(),a&&r.push(...o.flatMap(f=>n.map(d=>l(a,f,d,u))))},{immediate:!0,flush:"post"}),v=()=>{m(),i()};return x(v),v}function Y(){const e=V(!1);return P()&&M(()=>{e.value=!0}),e}function Z(e){const t=Y();return I(()=>(t.value,!!e()))}function ee(e={}){const{window:t=B}=e,o=Z(()=>!!t&&"Notification"in t),n=V(null),s=async()=>{o.value&&"permission"in Notification&&Notification.permission!=="denied"&&await Notification.requestPermission()},{on:r,trigger:i}=k(),{on:l,trigger:m}=k(),{on:v,trigger:a}=k(),{on:u,trigger:f}=k(),d=async h=>{if(!o.value)return;await s();const c=Object.assign({},e,h);return n.value=new Notification(c.title||"",c),n.value.onclick=i,n.value.onshow=m,n.value.onerror=a,n.value.onclose=f,n.value},y=()=>{n.value&&n.value.close(),n.value=null};if(K(async()=>{o.value&&await s()}),x(y),o.value&&t){const h=t.document;X(h,"visibilitychange",c=>{c.preventDefault(),h.visibilityState==="visible"&&y()})}return{isSupported:o,notification:n,show:d,close:y,onClick:r,onShow:l,onError:v,onClose:u}}const se={__name:"HomeHome",setup(e){const t=D(),{items:o,currentItem:n,timeleft:s}=j(t),r=G(),i={STOP:0,COUNTING:1,PAUSE:2},l=V(i.STOP);let m=0;const v=()=>{l.value===i.STOP&&o.value.length>0&&t.setCurrentItem(),n.value.length!==0&&(l.value=i.COUNTING,m=setInterval(()=>{t.countdown(),s.value===0&&u()},1e3))},a=()=>{l.value=i.PAUSE,clearInterval(m)},u=()=>{clearInterval(m),l.value=i.STOP;const c=new Audio;if(c.src=r.selectsdAlarmFile,c.play(),r.notify){const{show:S}=ee({title:"事項完成",body:f.value,icon:r.selectsdImg});S()}t.setFinishItem(),o.value.length>0&&v()},f=I(()=>n.value.length>0?n.value:o.value.length>0?"點擊開始":"沒有事項"),d=I(()=>{const c=Math.floor(s.value/60).toString().padStart(2,"0"),S=(s.value%60).toString().padStart(2,"0");return c+":"+S}),y=()=>{r.selectedAlarm>1?r.selectedAlarm--:r.selectedAlarm=6},h=()=>{r.selectedAlarm<6?r.selectedAlarm++:r.selectedAlarm=1};return(c,S)=>(T(),C(q,null,{default:p(()=>[g($,{class:"text-center"},{default:p(()=>[g(N,{cols:"12"},{default:p(()=>[O("h1",null,b(f.value),1),O("h1",null,b(d.value),1)]),_:1}),g(N,{cols:"12"},{default:p(()=>[g(w,{onClick:y},{default:p(()=>[E("上一首")]),_:1}),g(R,{src:_(r).selectsdImg,height:350,width:350,cover:"",style:{display:"inline-block","border-radius":"45%"}},null,8,["src"]),g(w,{onClick:h},{default:p(()=>[E("下一首")]),_:1})]),_:1}),g(N,{cols:"12"},{default:p(()=>[l.value!==i.COUNTING?(T(),C(w,{key:0,variant:"text",icon:"mdi-play",onClick:v})):A("",!0),l.value===i.COUNTING?(T(),C(w,{key:1,variant:"text",icon:"mdi-pause",onClick:a})):A("",!0),_(n).length>0?(T(),C(w,{key:2,variant:"text",icon:"mdi-skip-next",onClick:u})):A("",!0)]),_:1})]),_:1})]),_:1}))}};export{se as default};
